@go.Package { name = "github.com/kdeps/schema/gen/workflow" }

module org.kdeps.pkl.Workflow

import "package://pkg.pkl-lang.org/pkl-go/pkl.golang@0.5.0#/go.pkl"

import "Project.pkl"
import "Parameters.pkl"

hidden nameStringRegex = Regex(#"(^\w+$)"#)
hidden versionStringRegex = Regex(#"^(\d+\.)?(\d+\.)?(\*|\d+)$"#)

hidden isValidName = (str) ->
if (str.matches(nameStringRegex))
  true
else
  throw("Error: Invalid name: The name contains invalid characters. Please ensure it only includes alphanumeric characters (letters and numbers) and is not empty.")

hidden isValidAction = (str) ->
if (str.matches(nameStringRegex))
  true
else
  throw("Error: Invalid action: The action contains invalid characters. Please ensure it only includes alphanumeric characters (letters and numbers) and is not empty.")

hidden isValidVersion = (str) ->
if (str.matches(versionStringRegex))
  true
else
  throw("Error: Invalid version format. Expected format: major.minor.patch or major.minor.")

name: String(isValidName)
version: String(versionRegex) = "1.0.0"
action: String(isValidAction)

settings: Project.Settings?
workflows: Listing<Uri>
args: Listing<Parameters.Args>?
